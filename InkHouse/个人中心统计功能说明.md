# 个人中心统计功能说明

## 功能概述

个人中心新增了详细的借阅和座位预约统计功能，帮助用户了解自己的使用情况。

## 统计信息

### ? 借阅统计
- **总借阅次数**: 用户所有借阅记录的总数
- **当前借阅**: 正在借阅中的图书数量
- **已归还**: 已经归还的图书数量
- **首次借阅**: 用户第一次借阅的日期
- **归还率**: 已归还图书占总借阅次数的比例（进度条显示）

### ? 座位预约统计
- **总预约次数**: 用户所有座位预约记录的总数
- **当前预约**: 正在预约或使用中的座位数量
- **已完成**: 已经完成的预约数量
- **首次预约**: 用户第一次预约的日期
- **完成率**: 已完成预约占总预约次数的比例（进度条显示）

## 功能特点

### 1. 实时更新
- 统计数据会在以下情况自动更新：
  - 用户借阅新图书
  - 用户归还图书
  - 用户预约座位
  - 用户完成座位使用
  - 进入个人中心页面

### 2. 手动刷新
- 点击"? 刷新"按钮可以手动更新统计数据
- 确保数据与数据库保持同步

### 3. 可视化显示
- 使用不同颜色区分不同类型的数据：
  - ? 蓝色：总数和首次使用日期
  - ? 橙色：当前进行中的项目
  - ? 绿色：已完成的项目
- 进度条直观显示完成率

### 4. 智能显示
- 当没有数据时，日期显示为"暂无"
- 当总数为0时，进度条自动隐藏
- 所有统计信息都使用跨平台中文字体显示

## 数据来源

统计数据来源于：
- **借阅记录**: `BorrowRecords` 表中的用户记录
- **预约记录**: `SeatReservations` 表中的用户记录

## 状态说明

### 借阅状态
- **借出/借阅中**: 计入当前借阅
- **归还/已归还**: 计入已归还

### 预约状态
- **已预约/使用中**: 计入当前预约
- **已离馆/已完成**: 计入已完成

## 技术实现

- 使用 MVVM 模式，数据绑定自动更新UI
- 统计计算在 `UserMainWindowViewModel` 中完成
- 支持跨平台字体显示，确保在不同操作系统上都能正确显示中文
- 使用进度条组件显示完成率
- 自定义转换器处理日期显示和可见性控制

## 使用建议

1. **定期查看统计**: 了解自己的使用习惯
2. **关注完成率**: 保持良好的借阅和预约习惯
3. **及时刷新**: 确保数据准确性
4. **跨平台使用**: 在不同操作系统上都能获得一致的体验 